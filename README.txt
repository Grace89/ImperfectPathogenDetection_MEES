The data used in the analyses and figures can be found on the dryad data repository searching for:
Imperfect pathogen detection from non-invasive skin swabs biases disease inference
DiRenzo, Graziella; Grant, Evan; Longo, Ana; Che-Castaldo, Christian; Zamudio, Kelly; Lips, Karen

* Please feel free to contact me at grace.direnzo@gmail.com if you are having trouble with the code, need help with explanations of what the files are, or the files do not work on your machine.

AppendixS2 > Figure Code
Simulation_figures.R
  # Used to create the figures for the simulations in the main text and Appendix S1

AppendixS2 > Generate document
AppendixS2.Rmd
  # Use to generate Appendix S2 (.Rmd file)

Figures
Bayesianpvalue.R
  # Creates a figure to visualize the Bayesian p-value 
  # Calculates the Bayesian p-value 
Fig1_detection_Figure.R
  # Creates Figure 1 in the main text
Fig2_Pstar_combo.R
  # Creates Figure 2 in the main text
  
Model> Model code >
Double_Swab_Imperfect_sampling.R
  # Formats the data
  # Write the imperfect sampling detection model
  # Bundles the data
  # Runs the model 
Double_Swab_IGNORING_imperfect_sampling.R
  # Formats the data
  # Write the imperfect sampling detection model
  # Bundles the data
  # Runs the model 
 Replicate_Miller_Figure.R
  # Recreates Fig. 2 from Miller et al. 2012 MEES
  
Model> Model code > Model output
adjusted.rda 
   # JAGS output for model with imperfect sampling detection
NOTadjusted.rda 
   # JAGS output for model IGNORING imperfect sampling detection
Miller.rda
   # JAGS output for model replicating model output for Miller et al. 2012

Model>  Simulate Miller et al. 2012 data
Simulate_Miller_2012.R
  #This file simulates the data for Miller et al. 2012, runs the model, and saves the model output

Parameter comparisons
Comparisons.R
  # Compares the parameter estimates between the imperfect pathogen detection model and the unadjusted model

Simulations > Code HPC
Create parameter combinations.R
  # Used to create sampling and parameter value scenarios for simualtions 
Simulations > Code HPC > High lambda
  # Code to submit jobs, scirpt, model, and parameter values to HPC when lambda is high
 Simulations > Code HPC > Low lambda
  # Code to submit jobs, scirpt, model, and parameter values to HPC when low is high

Simulations > Data file generated
  # All data files generated by the HPC

Simulations > Figures
  # Code used to make the simulation figures in the main text and the Sppendix S!


